-- this isnt meant to be obfuscated, dw, its just a ws connection handler that maps ws <-> api
local a=getgenv().__astolfoaim_api or loadstring(game:HttpGetAsync'https://astolfoaim.femboy.cafe/','apiloader')()a:Cleanup()a.SetState(false,true)local b={}if WebSocket then b.connect=function(c)local d={}local e=WebSocket.connect(c)d.internal=e;d.OnMessage=e.OnMessage;d.OnClose=e.OnClose;d.Send=function(self,f)return self.internal:Send(f)end;d.Close=function(self)return self.internal:Close()end;return d end elseif WebsocketClient and WebsocketClient.new then b.connect=function(c)local e=WebsocketClient.new(c)local d={}d.internal=e;d.OnMessage={['Connect']=function(self,...)return e.DataReceived:Connect(...)end}d.OnClose={['Connect']=function(self,...)return e.ConnectionClosed:Connect(...)end}d.Send=function(self,f)return self.internal:Send(f)end;d.Close=function(self)return self.internal:Close()end;e:Connect()return d end elseif syn and syn.websocket and syn.websocket.connect and not WebSocket then b.connect=function(c)local d={}local e=syn.websocket.connect(c)d.internal=e;d.OnMessage=e.OnMessage;d.OnClose=e.OnClose;d.Send=function(self,f)return self.internal:Send(f)end;d.Close=function(self)return self.internal:Close()end;return d end else error'No Websocket Library Present :/'end;local g=AstolfoAPIDomain or'https://aim.femboy.cafe'local h=http and http.request or http_request or request or syn and syn.request;if not h then error'No Request Function'end;local i=getgenv().AstolfoIdentificationCode and{Body=getgenv().AstolfoIdentificationCode}or h{Url=g..'/get-connection-code'}if not i then error'no code ok'end;i=i.Body;local j;j=function()local k=string.gsub(string.gsub(g,'https','wss'),'http','ws')..'/c/'..i;local e=b.connect(k)local l=true;e.OnMessage:Connect(function(f)if string.sub(f,1,5)=='exec:'then f=string.sub(f,6)local m='local api = ...;'..f;local n,o=loadstring(m)if not n then return e:Send('notif:Compilation Error: '..o)end;local p=tostring(n(a))e:Send('notif:'..p)end end)local q=os.clock()e.OnClose:Connect(function()l=false;rconsoleprint'Connection Closed.\n'task.wait(math.max(os.clock()-q+15,5))rconsoleprint'Retrying Connection...\n'j()end)if rconsoleshow then rconsoleshow()end;task.spawn(function()while e and l do e:Send'keepalive'task.wait(1)end end)end;j()task.spawn(function()pcall(function()setclipboard(i)end)end)if getgenv().__use_messagebox then(messageboxasync or messagebox or function()end)(i,'Code',0)end;if rconsolecreate then pcall(rconsolecreate,'ok')end;rconsoleprint'Code: 'rconsoleprint(i)rconsoleprint'\nEnter it in the Web UI: 'rconsoleprint(g..'/ui')rconsoleprint'\nDO NOT SHARE IT WITH ANYONE.\n'return a
